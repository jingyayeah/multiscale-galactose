segments(bac1981$age[k]-bac1981$ageSd[k], bac1981$volLiver[k],
bac1981$age[k]+bac1981$ageSd[k], bac1981$volLiver[k])
# vertical
segments(bac1981$age[k], bac1981$volLiver[k]+bac1981$volLiverSd[k],
bac1981$age[k], bac1981$volLiver[k]-bac1981$volLiverSd[k])
}
# mean data from Thompson1965
head(tom1965)
for (k in c(1,2)){
# horizontal
segments(tom1965$ageMin[k], tom1965$volLiver[k],
tom1965$ageMax[k], tom1965$volLiver[k])
# vertical
segments(tom1965$age[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$age[k], tom1965$volLiver[k]-tom1965$volLiverSd[k])
}
# sex [M], age [years], bodyweight [kg], liverWeight [kg]
tom1965 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Thompson1965.csv"), sep="\t")
tom1965$gender <- as.character(tom1965$sex)
tom1965$gender[tom1965$gender=='M'] <- 'male'
tom1965$gender[tom1965$gender=='F'] <- 'female'
tom1965$volLiver <- tom1965$liverWeight/f_liver_density * 1000; # [ml]
tom1965$volLiverSd <- tom1965$liverWeightSd/f_liver_density * 1000; # [ml]
head(tom1965)
xname <- 'age'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind( mar1988[, selection],
wyn1989.fig2a[, selection],
naw1998[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. age',xname='age', yname='volLiver',
xlab='Age [years]', ylab='Liver volume [ml]',
xlim=c(0,90), ylim=c(600,2000))
# mean data from Swift1978
for (k in c(1,2)){
segments(swi1978$minAge[k], swi1978$volLiver[k],
swi1978$maxAge[k], swi1978$volLiver[k])
segments(0.5*(swi1978$minAge[k] + swi1978$maxAge[k]), swi1978$volLiver[k]+swi1978$volLiverSd[k],
0.5*(swi1978$minAge[k] + swi1978$maxAge[k]), swi1978$volLiver[k]-swi1978$volLiverSd[k])
}
# mean data from Bach1981
for (k in c(1,2)){
# horizontal
segments(bac1981$age[k]-bac1981$ageSd[k], bac1981$volLiver[k],
bac1981$age[k]+bac1981$ageSd[k], bac1981$volLiver[k])
# vertical
segments(bac1981$age[k], bac1981$volLiver[k]+bac1981$volLiverSd[k],
bac1981$age[k], bac1981$volLiver[k]-bac1981$volLiverSd[k])
}
# mean data from Thompson1965
head(tom1965)
for (k in c(1,2)){
# horizontal
segments(tom1965$ageMin[k], tom1965$volLiver[k],
tom1965$ageMax[k], tom1965$volLiver[k])
# vertical
segments(tom1965$age[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$age[k], tom1965$volLiver[k]-tom1965$volLiverSd[k])
}
head(tom1965)
for (k in 1:nrow(tom1965)){
sex <- tom1965$gender[k]
col <- gender.cols[which(gender.levels == sex)]
# horizontal
segments(tom1965$ageMin[k], tom1965$volLiver[k],
tom1965$ageMax[k], tom1965$volLiver[k], col=col)
# vertical
segments(tom1965$age[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$age[k], tom1965$volLiver[k]-tom1965$volLiverSd[k], col=col)
}
head(tom1965)
xname <- 'bodyweight'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. bodyweight', xname='bodyweight', yname='volLiver',
xlab='bodyweight [kg]', ylab='Liver volume [ml]',
xlim=c(40,120), ylim=c(500, 2500))
head(del1968.fig1)
for (k in 1:nrow(del1968.fig1)){
print(k)
# horizontal
sex <- del1968.fig1$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(del1968.fig1$weightMin[k], del1968.fig1$volLiver[k],
del1968.fig1$weightMax[k], del1968.fig1$volLiver[k], col=col)
# vertical
segments(del1968.fig1$weight[k], del1968.fig1$volLiver[k]+del1968.fig1$volLiverSd[k],
del1968.fig1$weight[k], del1968.fig1$volLiver[k]-del1968.fig1$volLiverSd[k], col=col)
}
head(tom1965)
for (k in 1:nrow(tom1965)){
sex <- tom1965$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(tom1965$bodyweight[k]-tom1965$bodyweightSd[k], tom1965$volLiver[k],
tom1965$bodyweight[k]+tom1965$bodyweightSd[k], tom1965$volLiver[k], col=col)
segments(tom1965$bodyweight[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$bodyweight[k], tom1965$volLiver[k]-tom1965$volLiverSd[k], col=col)
}
xname <- 'age'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind( mar1988[, selection],
wyn1989.fig2a[, selection],
naw1998[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. age',xname='age', yname='volLiver',
xlab='Age [years]', ylab='Liver volume [ml]',
xlim=c(0,90), ylim=c(600,2000))
# mean data from Swift1978
for (k in c(1,2)){
segments(swi1978$minAge[k], swi1978$volLiver[k],
swi1978$maxAge[k], swi1978$volLiver[k])
segments(0.5*(swi1978$minAge[k] + swi1978$maxAge[k]), swi1978$volLiver[k]+swi1978$volLiverSd[k],
0.5*(swi1978$minAge[k] + swi1978$maxAge[k]), swi1978$volLiver[k]-swi1978$volLiverSd[k])
}
# mean data from Bach1981
for (k in c(1,2)){
# horizontal
segments(bac1981$age[k]-bac1981$ageSd[k], bac1981$volLiver[k],
bac1981$age[k]+bac1981$ageSd[k], bac1981$volLiver[k])
# vertical
segments(bac1981$age[k], bac1981$volLiver[k]+bac1981$volLiverSd[k],
bac1981$age[k], bac1981$volLiver[k]-bac1981$volLiverSd[k])
}
# mean data from Thompson1965
head(tom1965)
for (k in 1:nrow(tom1965)){
sex <- tom1965$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(tom1965$ageMin[k], tom1965$volLiver[k],
tom1965$ageMax[k], tom1965$volLiver[k], col=col)
segments(tom1965$age[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$age[k], tom1965$volLiver[k]-tom1965$volLiverSd[k], col=col)
}
alt1962 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Altman1962.csv"), sep="\t")
head(alt1962)
alt1962 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Altman1962.csv"), sep="\t")
alt1962$gender <- as.character(alt1962$sex)
alt1962$gender[alt1962$gender=='M'] <- 'male'
alt1962$gender[alt1962$gender=='F'] <- 'female'
alt1962$volLiver <- alt1962$liverWeight/f_liver_density * 1000; # [ml]
alt1962$volLiverSd <- alt1962$liverWeightSd/f_liver_density * 1000; # [ml]
head(alt1962)
xname <- 'age'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind( mar1988[, selection],
wyn1989.fig2a[, selection],
naw1998[, selection],
alt1962[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. age',xname='age', yname='volLiver',
xlab='Age [years]', ylab='Liver volume [ml]',
xlim=c(0,90), ylim=c(600,2000))
# mean data from Swift1978
for (k in c(1,2)){
segments(swi1978$minAge[k], swi1978$volLiver[k],
swi1978$maxAge[k], swi1978$volLiver[k])
segments(0.5*(swi1978$minAge[k] + swi1978$maxAge[k]), swi1978$volLiver[k]+swi1978$volLiverSd[k],
0.5*(swi1978$minAge[k] + swi1978$maxAge[k]), swi1978$volLiver[k]-swi1978$volLiverSd[k])
}
# mean data from Bach1981
for (k in c(1,2)){
# horizontal
segments(bac1981$age[k]-bac1981$ageSd[k], bac1981$volLiver[k],
bac1981$age[k]+bac1981$ageSd[k], bac1981$volLiver[k])
# vertical
segments(bac1981$age[k], bac1981$volLiver[k]+bac1981$volLiverSd[k],
bac1981$age[k], bac1981$volLiver[k]-bac1981$volLiverSd[k])
}
# mean data from Thompson1965
head(tom1965)
for (k in 1:nrow(tom1965)){
sex <- tom1965$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(tom1965$ageMin[k], tom1965$volLiver[k],
tom1965$ageMax[k], tom1965$volLiver[k], col=col)
segments(tom1965$age[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$age[k], tom1965$volLiver[k]-tom1965$volLiverSd[k], col=col)
}
xname <- 'age'
yname <- 'GEC'
selection <- c('study', 'gender', xname, yname)
data <- rbind( mar1988[, selection],
tyg1962[, selection],
sch1986.tab1[, selection],
win1965[, selection],
duc1979[, selection])
data$gender <- as.factor(data$gender)
levels(data$gender) <- gender.levels
data <- data[complete.cases(data), ]  # remove NA
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='GEC vs. age', xname='age', yname='GEC',
xlab='Age [years]', ylab='GEC [mmol/min]',
xlim=c(0,90), ylim=c(0,5))
hei1999 <- read.csv(file.path(ma.settings$dir.expdata, "GEC", "Heinemann1999.csv"), sep="\t")
hei1999 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Heinemann1999.csv"), sep="\t")
hei1999$gender <- as.character(hei1999$sex)
hei1999 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Heinemann1999.csv"), sep="\t")
hei1999$gender <- as.character(hei1999$sex)
hei1999$gender[hei1999$gender=='M'] <- 'male'
hei1999$gender[hei1999$gender=='F'] <- 'female'
hei1999$volLiver <- hei1999$liverVol
head(hei1999)
hei1999 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Heinemann1999.csv"), sep="\t")
hei1999$gender <- as.character(hei1999$sex)
hei1999$gender[hei1999$gender=='U'] <- 'all'
hei1999$volLiver <- hei1999$liverVol
head(hei1999)
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(1.2,2.4), ylim=c(500, 2500))
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(1.2,2.4), ylim=c(500, 2500))
head(hei1999)
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection])
data <- rbind(naw1998[, selection],
hei1999[, selection])
xname <- 'BSA'
yname <- 'volLiver'
data <- rbind(naw1998[, selection],
hei1999[, selection])
names(hei1999)
hei1999 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Heinemann1999.csv"), sep="\t")
hei1999$gender <- as.character(hei1999$sex)
hei1999$gender[hei1999$gender=='U'] <- 'all'
hei1999$volLiver <- hei1999$liverVol
head(hei1999)
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection])
names(hei1999)
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(1.2,2.4), ylim=c(500, 2500))
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(0.5,2.5), ylim=c(500, 2500))
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(0.5,2.5), ylim=c(0, 4000))
ura1995 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Urata1995.csv"), sep="\t")
ura1995$gender <- as.character(ura1995$sex)
ura1995$gender[ura1995$gender=='U'] <- 'all'
ura1995$volLiver <- ura1995$liverVol
head(ura1995)
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection],
ura1995[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(0.5,2.5), ylim=c(0, 4000))
vau2002.fig1 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Vauthey2002_Fig1.csv"), sep="\t")
vau2002.fig1 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Vauthey2002_Fig1.csv"), sep="\t")
vau2002.fig1$gender <- as.character(vau2002.fig1$sex)
vau2002.fig1$gender[vau2002.fig1$gender=='U'] <- 'all'
vau2002.fig1$volLiver <- vau2002.fig1$liverVol
head(vau2002.fig1)
vau2002.fig2 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Vauthey2002_Fig2.csv"), sep="\t")
vau2002.fig2 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Vauthey2002_Fig2.csv"), sep="\t")
vau2002.fig2$gender <- as.character(vau2002.fig2$sex)
vau2002.fig2$gender[vau2002.fig2$gender=='U'] <- 'all'
vau2002.fig2$volLiver <- vau2002.fig2$liverVol
head(vau2002.fig2)
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection],
ura1995[, selection],
vau2002.fig1[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(0.5,2.5), ylim=c(0, 4000))
head(del1968.fig4)
for (k in 1:nrow(del1968.fig4)){
print(k)
# horizontal
sex <- del1968.fig4$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(del1968.fig4$BSAMin[k], del1968.fig4$volLiver[k],
del1968.fig4$BSAMax[k], del1968.fig4$volLiver[k], col=col)
# vertical
segments(del1968.fig4$BSA[k], del1968.fig4$volLiver[k]+del1968.fig4$volLiverSd[k],
del1968.fig4$BSA[k], del1968.fig4$volLiver[k]-del1968.fig4$volLiverSd[k], col=col)
}
xname <- 'bodyweight'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
vau2002.fig2[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. bodyweight', xname='bodyweight', yname='volLiver',
xlab='bodyweight [kg]', ylab='Liver volume [ml]',
xlim=c(40,120), ylim=c(500, 2500))
head(del1968.fig1)
for (k in 1:nrow(del1968.fig1)){
print(k)
# horizontal
sex <- del1968.fig1$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(del1968.fig1$weightMin[k], del1968.fig1$volLiver[k],
del1968.fig1$weightMax[k], del1968.fig1$volLiver[k], col=col)
# vertical
segments(del1968.fig1$weight[k], del1968.fig1$volLiver[k]+del1968.fig1$volLiverSd[k],
del1968.fig1$weight[k], del1968.fig1$volLiver[k]-del1968.fig1$volLiverSd[k], col=col)
}
head(tom1965)
for (k in 1:nrow(tom1965)){
sex <- tom1965$gender[k]
col <- gender.cols[which(gender.levels == sex)]
segments(tom1965$bodyweight[k]-tom1965$bodyweightSd[k], tom1965$volLiver[k],
tom1965$bodyweight[k]+tom1965$bodyweightSd[k], tom1965$volLiver[k], col=col)
segments(tom1965$bodyweight[k], tom1965$volLiver[k]+tom1965$volLiverSd[k],
tom1965$bodyweight[k], tom1965$volLiver[k]-tom1965$volLiverSd[k], col=col)
}
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection],
ura1995[, selection],
vau2002.fig1[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(0.5,2.5), ylim=c(0, 4000))
2003
yos2003 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Yoshizumi2003.csv"), sep="\t")
yos2003 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Yoshizumi2003.csv"), sep="\t")
yos2003$gender <- as.character(yos2003$sex)
yos2003$gender[yos2003$gender=='U'] <- 'all'
head(yos2003)
yos2003 <- read.csv(file.path(ma.settings$dir.expdata, "liver_volume", "Yoshizumi2003.csv"), sep="\t")
yos2003$gender <- as.character(yos2003$sex)
yos2003$gender[yos2003$gender=='U'] <- 'all'
yos2003$volLiver <- yos2003$liverWeight/f_liver_density ; # [ml]
head(yos2003)
xname <- 'BSA'
yname <- 'volLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind(naw1998[, selection],
hei1999[, selection],
ura1995[, selection],
vau2002.fig1[, selection],
yos2003[,selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Liver volume vs. BSA', xname='BSA', yname='volLiver',
xlab='Body surface area (BSA) [m^2]', ylab='Liver volume [ml]',
xlim=c(0.5,2.5), ylim=c(0, 4000))
############################################
xname <- 'age'
yname <- 'flowLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind( win1965[, selection],
wyn1989.fig3a[, selection])
data$gender <- as.factor(data$gender)
levels(data$gender) <- gender.levels
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Blood flow vs. age',xname='age', yname='flowLiver',
xlab='Age [years]', ylab='Blood flow liver [ml/min]',
xlim=c(0,90), ylim=c(400,3000))
xname <- 'age'
yname <- 'flowLiver'
selection <- c('study', 'gender', xname, yname)
data <- rbind( win1965[, selection],
wyn1989.fig3a[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Blood flow vs. age',xname='age', yname='flowLiver',
xlab='Age [years]', ylab='Blood flow liver [ml/min]',
xlim=c(0,90), ylim=c(400,3000))
xname <- 'age'
yname <- 'flowLiverkg'
selection <- c('study', 'gender', xname, yname)
data <- rbind( win1965[, selection],
wyn1989.fig3b[, selection])
data$gender <- as.factor(data$gender)
levels(data$gender) <- gender.levels
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Blood flow per bodyweight vs. age', xname='age', yname='flowLiverkg',
xlab='Age [years]', ylab='Blood flow liver per bodyweight [ml/min/kg]',
xlim=c(0,90), ylim=c(0,40))
############################################
xname <- 'age'
yname <- 'flowLiverkg'
selection <- c('study', 'gender', xname, yname)
data <- rbind( win1965[, selection],
wyn1989.fig3b[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Blood flow per bodyweight vs. age', xname='age', yname='flowLiverkg',
xlab='Age [years]', ylab='Blood flow liver per bodyweight [ml/min/kg]',
xlim=c(0,90), ylim=c(0,40))
xname <- 'age'
yname <- 'perfusion'
selection <- c('study', 'gender', xname, yname)
data <- rbind( wyn1989.fig4[, selection])
data$gender <- as.factor(data$gender)
levels(data$gender) <- gender.levels
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Perfusion vs. age', xname='age', yname='perfusion',
xlab='Age [years]', ylab='Perfusion [ml/min/ml]',
xlim=c(0,90), ylim=c(0,2))
xname <- 'age'
yname <- 'perfusion'
selection <- c('study', 'gender', xname, yname)
data <- rbind( wyn1989.fig4[, selection])
m1 <- linear_regression(data, xname, yname)
reg.models[[id]] = m1
reg.data[[id]] = data
id = id + 1
makeFigure(data, m1, main='Perfusion vs. age', xname='age', yname='perfusion',
xlab='Age [years]', ylab='Perfusion [ml/min/ml]',
xlim=c(0,90), ylim=c(0,2))
