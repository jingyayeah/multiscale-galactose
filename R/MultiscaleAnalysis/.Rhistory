rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
if (kc==1){
plot(time, rmean*f_scale, col=ccolors[kc], lwd=3, 'l',
main="Dilution Curves", xlab="time [s]", ylab="c [mM]",
ylim=c(0.0, 15), xlim=c(0.0, 30) )
}else {
lines(time, rmean, col=ccolors[kc], lwd=3)
}
lines(time, rmean+rstd, col=ccolors[kc], lwd=1, lty=2)
lines(time, rmean-rstd, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
## Goresky1983 & 1973 ##
#plot(numeric(0), numeric(0),
#     xlim=c(0,30), ylim=c(0,16),
#     xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=90
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and variance for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
if (kc==1){
plot(time, rmean*f_scale, col=ccolors[kc], lwd=3, 'l',
main="Dilution Curves", xlab="time [s]", ylab="c [mM]",
ylim=c(0.0, 15), xlim=c(0.0, 30) )
}else {
lines(time, rmean*f_scale, col=ccolors[kc], lwd=3)
}
lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
## Goresky1983 & 1973 ##
#plot(numeric(0), numeric(0),
#     xlim=c(0,30), ylim=c(0,16),
#     xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=90
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and variance for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
if (kc==1){
plot(time, rmean*f_scale, col=ccolors[kc], lwd=3, 'l',
main="Dilution Curves", xlab="time [s]", ylab="c [mM]",
ylim=c(0.0, 15), xlim=c(0.0, 30) )
}else {
lines(time, rmean*f_scale, col=ccolors[kc], lwd=3)
}
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
#plot(numeric(0), numeric(0),
#     xlim=c(0,30), ylim=c(0,16),
#     xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,30), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=80
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=3)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,30), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=3)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
library(MultiscaleAnalysis)
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,30), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=4)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
library(MultiscaleAnalysis)
## Combined Dilution Curves in one plot ##
png(filename=paste(info.folder, '/', task, "_Dilution_Curves_Combined.png", sep=""),
width = 1000, height = 400, units = "px", bg = "white",  res = 150)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
compounds = c('gal', 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('black', 'red', 'darkgreen', 'darkorange', 'darkblue' )
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,22), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=4)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
dev.off()
## Combined Dilution Curves in one plot ##
png(filename=paste(ma.settings$dir.results, '/', task, "_Dilution_Curves_Combined.png", sep=""),
width = 1000, height = 400, units = "px", bg = "white",  res = 150)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
compounds = c('gal', 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('black', 'red', 'darkgreen', 'darkorange', 'darkblue' )
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,22), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=4)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
dev.off()
## Combined Dilution Curves in one plot ##
png(filename=paste(ma.settings$dir.results, '/', task, "_Dilution_Curves_Combined.png", sep=""),
width = 2000, height = 1000, units = "px", bg = "white",  res = 150)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
compounds = c('gal', 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('black', 'red', 'darkgreen', 'darkorange', 'darkblue' )
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,22), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=4)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
dev.off()
plot(numeric(0), numeric(0),
xlim=c(0,22), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=4)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
legend("topright",  legend = expcompounds, fill=expcolors)
png(filename=paste(ma.settings$dir.results, '/', task, "_Dilution_Curves_Combined.png", sep=""),
width = 2000, height = 1000, units = "px", bg = "white",  res = 150)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
compounds = c('gal', 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('black', 'red', 'darkgreen', 'darkorange', 'darkblue' )
compounds = c( 'rbcM', 'alb', 'suc', 'h2oM')
ccolors = c('red', 'darkgreen', 'darkorange', 'darkblue' )
gor1973 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1973_Fig1.csv"), sep="\t")
summary(gor1973)
# Units: time [s], compound: 1000*outflow fraction/ml
gor1983 <- read.csv(file.path(ma.settings$dir.expdata, "dilution_indicator", "Goresky1983_Fig1.csv"), sep="\t")
summary(gor1983)
plot(numeric(0), numeric(0),
xlim=c(0,20), ylim=c(0,16),
xlab="time [s]", ylab="10^3 x outflow fraction/ml", main="Goresky1973 & 1983")
par(mfrow=c(1,1))
for (kc in seq(1, length(compounds)) ){
f_scale=70
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
# plot one compound
tmp <- dilmat[[name]]
# plot the mean and std for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean*f_scale, col=ccolors[kc], lwd=4)
#lines(time, (rmean+rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
#lines(time, (rmean-rstd)*f_scale, col=ccolors[kc], lwd=1, lty=2)
}
#          red,  green, orange, blue,  black, gray
# expcompounds = c('RBC', 'albumin', 'Na', 'sucrose', 'water', 'galactose')
# expcolors = c('red', 'darkgreen', 'gray', 'darkorange', 'darkblue', 'black')
expcompounds = c('RBC', 'albumin', 'sucrose', 'water')
expcolors = c('red', 'darkgreen', 'darkorange', 'darkblue')
## Goresky1983 & 1973 ##
plotDilutionData(gor1983, compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="A",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="B",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
plotDilutionData(gor1973[gor1973$condition=="C",], compounds=expcompounds, ccolors=expcolors, correctTime=TRUE)
par(mfrow=c(1,1))
legend("topright",  legend = expcompounds, fill=expcolors)
dev.off()
# Plot all data curves and mean curve #
install.packages('matrixStats')
library('matrixStats')
png(filename=paste(ma.settings$results, '/', task, "_Dilution_Curves.png", sep=""),
width = 4000, height = 1000, units = "px", bg = "white",  res = 200)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
par(mfrow=c(1,length(compounds)))
for (kc in seq(length(compounds)) ){
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
print(name)
# plot one compound
tmp <- dilmat[[name]]
for (ks in seq(nrow(pars))){
if (ks == 1){
plot(time, tmp[,ks], col="gray", 'l', main=name, xlab="time [s]", ylab="c [mM]", ylim=c(0.0, 0.2), xlim=c(0, 30) )
} else {
lines(time, tmp[,ks], col="gray")
}
}
# plot the mean and variance for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean, col=ccolors[kc], lwd=2)
lines(time, rmean+rstd, col=ccolors[kc], lwd=2, lty=2)
lines(time, rmean-rstd, col=ccolors[kc], lwd=2, lty=2)
}
par(mfrow=c(1,1))
dev.off()
nrow(pars)
png(filename=paste(ma.settings$results, '/', task, "_Dilution_Curves.png", sep=""),
width = 4000, height = 1000, units = "px", bg = "white",  res = 200)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
par(mfrow=c(1,length(compounds)))
for (kc in seq(length(compounds)) ){
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
print(name)
# plot one compound
tmp <- dilmat[[name]]
for (ks in seq(nrow(pars))){
if (ks == 1){
plot(time, tmp[,ks], col="gray", 'l', main=name, xlab="time [s]", ylab="c [mM]", ylim=c(0.0, 0.2), xlim=c(0, 30) )
} else {
lines(time, tmp[,ks], col="gray")
}
}
# plot the mean and variance for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean, col=ccolors[kc], lwd=2)
lines(time, rmean+rstd, col=ccolors[kc], lwd=2, lty=2)
lines(time, rmean-rstd, col=ccolors[kc], lwd=2, lty=2)
}
par(mfrow=c(1,1))
dev.off()
nrow(pars)
library('matrixStats')
library('MultiscaleAnalysis')
png(filename=paste(ma.settings$results, '/', task, "_Dilution_Curves.png", sep=""),
width = 4000, height = 1000, units = "px", bg = "white",  res = 200)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
par(mfrow=c(1,length(compounds)))
for (kc in seq(length(compounds)) ){
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
print(name)
# plot one compound
tmp <- dilmat[[name]]
for (ks in seq(nrow(pars))){
if (ks == 1){
plot(time, tmp[,ks], col="gray", 'l', main=name, xlab="time [s]", ylab="c [mM]", ylim=c(0.0, 0.2), xlim=c(0, 30) )
} else {
lines(time, tmp[,ks], col="gray")
}
}
# plot the mean and variance for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean, col=ccolors[kc], lwd=2)
lines(time, rmean+rstd, col=ccolors[kc], lwd=2, lty=2)
lines(time, rmean-rstd, col=ccolors[kc], lwd=2, lty=2)
}
par(mfrow=c(1,1))
dev.off()
nrow(pars)
png(filename=paste(ma.settings$dir.results, '/', task, "_Dilution_Curves.png", sep=""),
width = 4000, height = 1000, units = "px", bg = "white",  res = 200)
time <- readTimeForSimulation(ma.settings$dir.simdata, rownames(pars)[1]) -10.0
par(mfrow=c(1,length(compounds)))
for (kc in seq(length(compounds)) ){
# name = "PV__rbcM"
name = paste("PV__", compounds[kc], sep="")
print(name)
# plot one compound
tmp <- dilmat[[name]]
for (ks in seq(nrow(pars))){
if (ks == 1){
plot(time, tmp[,ks], col="gray", 'l', main=name, xlab="time [s]", ylab="c [mM]", ylim=c(0.0, 0.2), xlim=c(0, 30) )
} else {
lines(time, tmp[,ks], col="gray")
}
}
# plot the mean and variance for time courses
rmean <- rowMeans(tmp)
rstd <- rowSds(tmp)
lines(time, rmean, col=ccolors[kc], lwd=2)
lines(time, rmean+rstd, col=ccolors[kc], lwd=2, lty=2)
lines(time, rmean-rstd, col=ccolors[kc], lwd=2, lty=2)
}
par(mfrow=c(1,1))
dev.off()
nrow(pars)
