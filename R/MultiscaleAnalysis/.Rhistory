png(filename=fname, width=plot.width, height=plot.height, units=plot.units, bg=plot.bg, res=plot.res)
plotWeighted(pars, p.gen, name)
dev.off()
}
calculateConversionFactors(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_liv.wmean
print(f_tissue)
}
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_liv.wmean
print(f_tissue)
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
pars
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
print(Q_liv/Q_sinunit.wmean)
print(Vol_liv/Vol_sinunit.wmean)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
print(Q_liv.wmean/Q_sinunit.wmean)
print(Vol_liv.wmean/Vol_sinunit.wmean)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
print(f_Q)
print(f_Vol)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_liv.sinunit
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
print(f_Q)
print(f_Vol)
N_Q = Q_liv.wmean/Q_sinunit.wmean
print(N_Q)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_sinunit.wmean
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = 1/N_Q * Vol_liv.wmean/Vol_sinunit.wmean
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
calculateConversionFactors <- function(pars){
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '\n')
}
calculateConversionFactors(pars)
pars
calculateConversionFactors <- function(pars){
res
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
N_Q.sd = Q_liv.wsd/Q_sinunit.wsd
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wsd
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
}
calculateConversionFactors(pars)
# calculate conversion factors
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
N_Q.sd = Q_liv.wsd/Q_sinunit.wsd
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wsd
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
# calculate conversion factors
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
N_Q.sd = Q_liv.wsd/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wsd
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
name='Q_sinunit'
wmean <- wt.mean(pars[[name]], pars$p_sample)
wmean
wvar <- wt.var(pars[[name]], pars$p_sample)
wvar
wsd <- wt.sd(pars[[name]], pars$p_sample)
wsd
plotWeighted(pars, p.gen, name)
library(MultiscaleAnalysis)
name='Q_sinunit'
wmean <- wt.mean(pars[[name]], pars$p_sample)
wmean
wvar <- wt.var(pars[[name]], pars$p_sample)
wvar
wsd <- wt.sd(pars[[name]], pars$p_sample)
wsd
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
N_Q.sd = Q_liv.wsd/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wsd
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
# propagation of uncertainty ???
N_Q.sd = 1/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/1
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
# calculate conversion factors
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
# propagation of uncertainty ???
N_Q.sd = Q_liv.wmean/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
# calculate conversion factors
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- 0.9* wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
# propagation of uncertainty ???
N_Q.sd = Q_liv.wmean/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
# calculate conversion factors
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- 0.8* wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
# propagation of uncertainty ???
N_Q.sd = Q_liv.wmean/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res
}
calculateConversionFactors(pars)
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
# propagation of uncertainty ???
N_Q.sd = Q_liv.wmean/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res$N_Q <- N_Q
res$N_Q.sd <- N_Q.sd
res$f_tissue <- f_tissue
res$f_tissue.sd <- f_tissue.sd
}
res <- calculateConversionFactors(pars)
res
calculateConversionFactors <- function(pars){
res <- list()
# varies depending on parameters
Q_sinunit.wmean <- wt.mean(pars[['Q_sinunit']], pars$p_sample)
Q_sinunit.wsd <- wt.sd(pars[['Q_sinunit']], pars$p_sample)
Vol_sinunit.wmean <- wt.mean(pars[['Vol_sinunit']], pars$p_sample)
Vol_sinunit.wsd <- wt.sd(pars[['Vol_sinunit']], pars$p_sample)
# constant normal value
Q_liv.wmean <- wt.mean(pars[['Q_liv']], pars$p_sample)
Q_liv.wsd <- wt.sd(pars[['Q_liv']], pars$p_sample)
Vol_liv.wmean <- wt.mean(pars[['Vol_liv']], pars$p_sample)
Vol_liv.wsd <- wt.sd(pars[['Vol_liv']], pars$p_sample)
f_Q = Q_liv.wmean/Q_sinunit.wmean
f_Vol = Vol_liv.wmean/Vol_sinunit.wmean
cat('f_Q: ', f_Q, '\n')
cat('f_Vol: ', f_Vol, '\n')
cat('f_Vol/f_Q: ', f_Vol/f_Q, '\n')
N_Q = Q_liv.wmean/Q_sinunit.wmean
# propagation of uncertainty ???
N_Q.sd = Q_liv.wmean/Q_sinunit.wsd
print(N_Q.sd)
cat('N_Q: ', N_Q, '\n')
N_Vol = N_Q
f_tissue = N_Vol * Vol_sinunit.wmean/Vol_liv.wmean
f_tissue.sd = N_Q.sd * Vol_sinunit.wsd/Vol_liv.wmean
cat('f_tissue: ', f_tissue, '+-', f_tissue.sd, '\n')
res$N_Q <- N_Q
res$N_Q.sd <- N_Q.sd
res$f_tissue <- f_tissue
res$f_tissue.sd <- f_tissue.sd
res
}
res <- calculateConversionFactors(pars)
names(res)
pars
